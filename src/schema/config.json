{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://ezbob.com/ui.config.schema.json",
  "title": "Configuration schema",
  "description": "JSON Schema document describing what are the possible values in UI configuration",
  "type": "object",
  "additionalProperties": true,
  "definitions": {
    "validationRules": {
      "$id": "#validationRules",
      "type": "string"
    },
    "customErrorMessage": {
      "$id": "#customErrorMessage",
      "type": "object"
    },
    "objectWithValidationRules": {
      "$id": "#objectWithValidationRules",
      "type": "object",
      "properties": {
        "validationRules": {
          "$ref": "#validationRules"
        },
        "customErrorMessage": {
          "$ref": "#customErrorMessage"
        }
      }
    },
    "linkedAccount": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "contentType": {
          "type": "string"
        },
        "linkedService": {
          "type": "string"
        },
        "accountType": {
          "type": "string"
        },
        "serviceName": {
          "type": "string"
        }
      }
    },
    "amazonAccountProp": {
      "type": "object",
      "$ref": "#objectWithValidationRules"
    },
    "accountStatement": {
      "description": "",
      "type": "object",
      "properties": {
        "linkAccountDetails": {
          "type": "object",
          "properties": {
            "displayIcons": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "upload": {
          "type": "object",
          "properties": {
            "maxFiles": {
              "type": "number",
              "minimum": 0
            },
            "maxSize": {
              "type": "number",
              "minimum": 0
            },
            "type": {
              "type": "string",
              "enum": ["BANK", "OTHER", "VAT"]
            },
            "fileExtensions": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  },
  "properties": {
    "system": {
      "description": "System settings",
      "type": "object",
      "properties": {
        "enableDeviceFraudCheck": {
          "description": "Turn on Iovation device fraud check",
          "type": "boolean"
        },
        "vendorName": {
          "description": "Vendor name (e.g. MetroBank)",
          "type": "string"
        },
        "uiVersion": {
          "description": "Deployed version of UI",
          "type": "string"
        },
        "inactiveLogout": {
          "description": "Defines after how many minutes to logout user",
          "type": "object",
          "required": ["minutes"],
          "properties": {
            "minutes": {
              "type": "number"
            }
          }
        },
        "checkFraud": {
          "description": "TODO",
          "type": "boolean"
        },
        "isProduction": {
          "description": "Is the app running in production mode",
          "type": "boolean"
        }
      }
    },
    "externalServices": {
      "description": "Connected external services",
      "type": "object",
      "properties": {
        "googleTagManager": {
          "description": "Google tag manager configuration",
          "type": "object",
          "properties": {
            "uaID": {
              "type": "string"
            },
            "gtmId": {
              "type": "string"
            },
            "allowedTracking": {
              "type": "object",
              "properties": {
                "VirtualPageview": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "InputTracking": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "ButtonTracking": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "locals": {
      "description": "Locale attributes",
      "type": "object",
      "properties": {
        "currencySign": {
          "type": "string"
        },
        "country": {
          "type": "string"
        },
        "countryCode": {
          "type": "string"
        },
        "currency": {
          "type": "string"
        }
      }
    },
    "product": {
      "description": "Product type",
      "type": "object",
      "properties": {
        "loanType": {
          "type": "string"
        }
      }
    },
    "pageRoutes": {
      "description": "SPA routes",
      "type": "object",
      "definitions": {
        "route": {
          "type": "object",
          "properties": {
            "url": {
              "type": "string"
            },
            "title": {
              "type": "string"
            },
            "excludeModules": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      },
      "patternProperties": {
        "^[a-zA-Z]+$": {
          "$ref": "#/properties/pageRoutes/definitions/route"
        }
      }
    },
    "modals": {
      "description": "Various in app modals",
      "type": "object",
      "properties": {
        "UploadDocModal": {
          "type": "object"
        },
        "ShareholderDetails": {
          "type": "object"
        },
        "LinkAccountDetails": {
          "type": "object"
        },
        "GeneralError": {
          "type": "object"
        }
      }
    },
    "steps": {
      "definitions": {
        "step": {
          "type": "object",
          "properties": {
            "stepName": {
              "type": "string"
            },
            "default": {
              "type": "boolean"
            },
            "progressBarStep": {
              "type": "string"
            },
            "excludeModules": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      },
      "description": "Configurations for wizard steps",
      "type": "array",
      "items": {
        "$ref": "#/properties/steps/definitions/step"
      }
    },
    "theme": {
      "description": "",
      "type": "object"
    },
    "updateUserFields": {
      "description": "",
      "type": "object",
      "properties": {
        "email": {
          "type": "string"
        },
        "password": {
          "type": "string"
        }
      }
    },
    "widgetsConfig": {
      "description": "",
      "type": "object"
    },
    "officers": {
      "description": "",
      "type": "object",
      "properties": {
        "showNextButton": {
          "type": "boolean"
        },
        "fraudIncludeThisIsMeShareholders": {
          "type": "boolean"
        },
        "fraudIncludeNotActiveShareholders": {
          "type": "boolean"
        },
        "enableWasEditSkipped": {
          "type": "boolean"
        },
        "type": {
          "type": "string",
          "enum": ["ALL"]
        },
        "includeCompanies": {
          "type": "boolean"
        },
        "personDetails": {
          "description": "Officers' personal details",
          "properties": {
            "address": {
              "$id": "#address",
              "type": "object",
              "anyOf": [
                {
                  "$ref": "#objectWithValidationRules"
                },
                {
                  "properties": {
                    "policyField": {
                      "type": "string"
                    },
                    "lastLineManualEditing": {
                      "type": "boolean"
                    },
                    "manualAddress": {
                      "$id": "#manualAddress",
                      "type": "object",
                      "properties": {
                        "line1": {
                          "$ref": "#objectWithValidationRules"
                        },
                        "line2": {
                          "$ref": "#objectWithValidationRules"
                        },
                        "town": {
                          "$ref": "#objectWithValidationRules"
                        },
                        "postcode": {
                          "$ref": "#objectWithValidationRules"
                        },
                        "country": {
                          "anyOf": [
                            { "$ref": "#objectWithValidationRules" },
                            {
                              "$ref": "#inputProps"
                            }
                          ]
                        }
                      }
                    }
                  }
                }
              ]
            },
            "birthDate": {
              "$id": "#birthDate",
              "type": "object",
              "anyOf": [
                {
                  "$ref": "#objectWithValidationRules"
                },
                {
                  "properties": {
                    "minAge": {
                      "type": "number",
                      "minimum": 0
                    },
                    "maxAge": {
                      "type": "number",
                      "minimum": 0
                    }
                  }
                }
              ]
            },
            "email": {
              "$id": "#email",
              "anyOf": [
                {
                  "$ref": "#objectWithValidationRules"
                },
                {
                  "properties": {
                    "inputProps": {
                      "$id": "#inputProps",
                      "type": "object"
                    }
                  }
                }
              ]
            },
            "fullName": {
              "$id": "#fullName",
              "properties": {
                "firstName": {
                  "$ref": "#objectWithValidationRules"
                },
                "middleName": {
                  "$ref": "#objectWithValidationRules"
                },
                "lastName": {
                  "$ref": "#objectWithValidationRules"
                }
              }
            }
          }
        }
      }
    },
    "personsSignificantControl": {
      "description": "",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["ALL"]
        },
        "includeCompanies": {
          "type": "boolean"
        }
      }
    },
    "meta": {
      "description": "",
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "consents": {
          "type": "object",
          "propertyNames": {
            "enum": [
              "privacyNote",
              "termsAndConditions",
              "authorizedDirector",
              "personalGuarantee"
            ]
          },
          "patternProperties": {
            "": {
              "type": "object",
              "allOf": [
                {
                  "properties": {
                    "defaultValue": {
                      "type": "boolean"
                    }
                  }
                },
                {
                  "$ref": "#objectWithValidationRules"
                }
              ]
            }
          }
        }
      }
    },
    "vatStatement": {
      "description": "",
      "$ref": "#/definitions/accountStatement"
    },
    "accountScoreStatement": {
      "description": "",
      "$ref": "#/definitions/accountStatement"
    },
    "bankAccountStatement": {
      "description": "",
      "$ref": "#/definitions/accountStatement"
    },
    "financialAccountsStatement": {
      "description": "",
      "$ref": "#/definitions/accountStatement"
    },
    "eCommerce": {
      "description": "",
      "type": "object",
      "propertyNames": {
        "enum": ["paypal", "ebay", "amazon"]
      },
      "patternProperties": {
        "": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string"
            }
          }
        }
      }
    },
    "linkAccount": {
      "description": "Link external providers' account",
      "type": "object",
      "properties": {
        "paypal": {
          "$ref": "#/definitions/linkedAccount"
        },
        "ebay": { "$ref": "#/definitions/linkedAccount" },
        "amazon": {
          "allOf": [
            {
              "$ref": "#/definitions/linkedAccount"
            },
            {
              "properties": {
                "sellerId": { "$ref": "#/definitions/amazonAccountProp" },
                "marketplaceId": { "$ref": "#/definitions/amazonAccountProp" },
                "authorizationToken": {
                  "$ref": "#/definitions/amazonAccountProp"
                }
              }
            }
          ]
        }
      }
    },
    "decision": {
      "description": "Decision config",
      "type": "object",
      "properties": {
        "decisionPolicy": {
          "type": "string",
          "enum": ["legacy", "v2"]
        },
        "minimumRequirements": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "widgetName": {
                "type": "string"
              },
              "minimum": {
                "type": "number",
                "minimum": 0
              }
            }
          }
        },
        "minimumMarketPlaceItems": {
          "type": "number"
        },
        "waitTime": {
          "type": "object",
          "propertyNames": {
            "enum": [
              "years",
              "y",
              "months",
              "M",
              "weeks",
              "w",
              "days",
              "d",
              "hours",
              "h",
              "minutes",
              "m",
              "seconds",
              "s",
              "milliseconds",
              "ms"
            ]
          },
          "patternProperties": {
            "": {
              "type": "number"
            }
          }
        }
      }
    },
    "popupLoader": {
      "description": "Popup loader configuration",
      "type": "object",
      "properties": {
        "type": {
          "description": "Type of loader animation",
          "type": "string"
        }
      }
    },
    "languages": {
      "description": "Supported languages configuration",
      "type": "object",
      "properties": {
        "defaultLanguage": {
          "description": "Default app language",
          "type": "string"
        },
        "fallbackLanguage": {
          "description": "Fallback language",
          "type": "string"
        },
        "languageList": {
          "description": "List of supported languages",
          "type": "object",
          "patternProperties": {
            "[a-z]{2}": {
              "description": "Key is language 2 letter code, `en` for example",
              "type": "object",
              "required": ["translation"],
              "properties": {
                "translation": {
                  "description": "All translation strings used in the app. Dynamic object",
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },
    "environments": {
      "description": "Various environment related configurations",
      "type": "object",
      "properties": {
        "appHost": {
          "type": "string"
        }
      }
    },
    "routing": {
      "description": "Define various routes to external sites",
      "type": "object",
      "required": ["systemUi"],
      "properties": {
        "logoutUrl": {
          "type": "string"
        },
        "systemUi": {
          "description": "This app's url",
          "type": "string"
        },
        "vendorWebsiteUrl": {
          "type": "string"
        }
      }
    },
    "fuzzyEnabled": {
      "description": "Is fuzzy logic enabled",
      "type": "boolean"
    },
    "ez1Up": {
      "description": "Is EZ1 up",
      "type": "boolean"
    },
    "caseMap": {
      "description": "Map structure to case field paths",
      "type": "object"
    }
  },
  "required": ["system"]
}
